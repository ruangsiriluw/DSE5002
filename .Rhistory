who_test <- who %>%
mutate(min_age = replace(min_age, min_age == NA, ""))
tail(who_test, n=10)
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, ""))
tail(who_test, n=10)
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, ''))
tail(who_test, n=10)
head(who_test)
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == '', 0))
tail(who_test, n=10)
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == '', 0))
mutate_at(8, ~replace_na(., 'Inf'))
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == '', 0)),
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, 'NA'))
tail(who_test, n=10)
who_test <- who %>%
mutate_at(7, ~replace_na(., 0))
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 0))
tail(who_test, n=10)
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, 'NA'))
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 0))
tail(who_test, n=10)
head(who_test)
who_test <- who_test %>%
mutate_at(7, ~replace_na(, 0))
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 0))
head(who_test)
tail(who_test, n=10)
tail(who, n=10)
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, 'NA'))
tail(who_test, n=10)
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 65))
head(who_test)
tail(who_test, n=10)
who_test <- who_test %>%
mutate(min_age = replace(min_age, min_age == 'NA', ))
who_test <- who_test %>%
mutate(min_age = replace(min_age, min_age == NA, ))
is.na(min_age)
is.na(who_test(min_age))
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, NA))
tail(who_test, n=10)
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 65))
str(who_test)
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 65))
who_test <- who_test %>%
mutate_at('min_age', ~as.numberic(replace_na(., 65)))
who_test <- who_test %>%
mutate_at('min_age', ~as.numeric(replace_na(., 65)))
who_test <- who_test %>%
mutate_at('min_age', ~as.numeric(replace_na(., 65)))
tail(who, n=10)
who_test <- who_test %>%
mutate_at("min_age", ~as.numeric(replace_na(., 65)))
who_test <- who %>%
mutate(min_age = replace(min_age, min_age == 0, NA))
who_test <- who_test %>%
mutate_at("min_age", ~as.numeric(replace_na(., 65)))
who_test <- who_test %>%
mutate_at("min_age", ~replace_na(., 65))
tail(who, n=10)
library(dplyr)
library(tidyr)
library(ggplot2)
###### Ex1
data(who)
data(population)
tail(who)
who <- who %>%
pivot_longer(
cols = new_sp_m014:newrel_f65,
names_to = c('diagnostic', 'gender', 'age'),
names_pattern = "new_?(.*)_(.)(.*)",
values_to = 'count'
)
tail(who)
who <- who %>%
left_join(population, by= c('country', 'year'))
head(who)
tail(who)
######## Ex3
?separate
who <- separate(who, col=age, into = c('min_age', 'max_age'),
sep = "(?<=\\d)(?=\\d{2}$)", remove = TRUE,
convert = FALSE, fill = "warn")
tail(who, n=10)
who_test <- who_test %>%
mutate_at("max_age", ~replace_na(., 65))
who_test <- who %>%
mutate_at("max_age", ~replace_na(., 65))
str(who_test)
who_test <- who %>%
who_test <- who %>%
mutate_at(8, ~replace_na(., 65))
tail(who, n=10)
who <- who %>%
mutate_at(8, ~replace_na(., 'Inf'))
tail(who, n=10)
who_test <- who %>%
mutate_at(max_age = replace(max_age, max_age == 'Inf', 65))
who_test <- who %>%
mutate(max_age = replace(max_age, max_age == 'Inf', 65))
tail(who_test, n=10)
who_test <- who_test %>%
mutate(min_age = replace(min_age, min_age == 65, NA))
tail(who_test, n=10)
who_test <- who_test %>%
mutate(min_age = ~replace.na(min_age, min_age == NA, 65))
who_test <- who_test %>%
mutate(min_age = replace.na(min_age, min_age == NA, 65))
who_test <- who_test %>%
mutate(min_age = ~replace.na(min_age, 65))
who_test <- who_test %>%
mutate(min_age = ~replace.na(list(min_age), 65))
tail(who_test, n=10)
#Test replace_na but not working:
who_test <- who_test %>%
mutate(min_age = ~replace.na(., 65))
who_test <- who_test %>%
mutate_at(7, ~replace.na(., 65))
who_test <- who_test %>%
mutate_at(7, ~replace_na(., 65))
#Test replace_na but not working:
str(min_age)
#Test replace_na but not working:
str(who_test$min_age)
?sum
who %>%
mutate_at('count', ~replace_na(., 0))
tail(who)
who %>%
summarise(sum = sum(count), by = diagnostic, groups = gender)
who %>%
group_by(gender) %>%
summarise(sum = sum(count), by = diagnostic)
remove(who_test)
library(dplyr)
sales <- read.csv("Week_4/Data/sales.csv", stringsAsFactors=FALSE)
names(sales)
sales %>%
group_by(Segment) %>%
summarize(sales = sum(Sales))
sales %>%
group_by(Segment,Category) %>%
summarize(sales=sum(Sales),
transactions = n(),  #count
distinct_products = n_distinct(Product.Name), #only use distinct prod name
average_transaction_sale = sum(sales) / n())
who %>%
group_by(diganostic, gender) %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
who %>%
group_by('diganostic', 'gender') %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
who %>%
group_by(diganostic, gender) %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count),
transactions = n(),  #count
distinct_dign = n_distinct(diagnostic),
)
who %>%
mutate_at('count', ~replace_na(., 0))
tail(who)
who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
tail(who)
print(summary_counts)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(sums = sum(count),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
tail(who)
head(who)
who %>%
mutate_at('count', ~replace_na(., 0))
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count),
na.rm = TRUE,
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = TRUE),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
str(who$diagnostic)
who$diagnostic <- factor(who$diagnostic)
str(who$diagnostic)
head(who)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = TRUE),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
who %>%
mutate_at('count', ~replace_na(., 0))
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = FALSE),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = TRUE),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
head(who)
tail(who)
head(who)
who <- who %>%
mutate_at('count', ~replace_na(., 0))
head(who)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = FALSE),
distinct_dign = n_distinct(diagnostic),
)
print(summary_counts)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = FALSE)
)
print(summary_counts)
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of patients per diagnostic')
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of patients per diagnostic') +
facet_grid(.~diagnostic)
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Events')
facet_grid(.~diagnostic)
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Events')
facet_grid(.~diagnostic)
ggplot(who,aes(x=gender,y = count)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Events')
, fill=diagnostic
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Events')
facet_grid(.~diagnostic)
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Events') +
facet_grid(.~diagnostic)
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Counts') +
facet_grid(.~diagnostic)
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
summarise(pct = count/population, na.rm = TRUE)
print(pct_pop_df)
View(pct_pop_df)
who <- who %>%
mutate_at('population', ~replace_na(., 0))
head(who)
tail(who)
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
summarise(pct = count/population)
View(pct_pop_df)
who <- who %>%
mutate_at('population', ~replace_na(., 0))
tail(who)
who %>%
who$pct_pop = who(who$count/who$population)
who %>%
who$pct_pop = who(count/population)
who %>%
who$pct_pop = who[count/population]
who %>%
who$pct_pop = count/population
who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population)
tail(who)
who <- who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population)
tail(who)
head(who, n=10)
head(who, n20)
head(who, n=20)
tail(who, n=20)
View(who)
who <- who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population)
summarise(percent, na.rm = FALSE)
pct_pop_df <- who %>%
mutate(percent = count/population)
pct_pop_df <- who %>%
mutate(percent = count/population)
group_by(year, gender, diagnostic) %>%
summarise(percent, na.rm = FALSE)
View(pct_pop_df)
pct_pop_df <- who %>%
mutate(percent = count/population) %>%
group_by(year, gender, diagnostic) %>%
summarise(percent, na.rm = FALSE)
pct_pop_df <- who %>%
mutate(percent = count/population) %>%
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
summarise(percent, na.rm = FALSE)
pct_pop_df <- who %>%
mutate(percent = count/population) %>%
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
summarise(percent = percent * 100, na.rm = FALSE)
View(pct_pop_df)
pct_pop_df <- who %>%
mutate(percent = count/population) %>%
head(pct_pop_df)
pct_pop_df <- who %>%
mutate(percent = count/population) %>%
tail(pct_pop_df)
tail(who)
head(who)
who <- who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population, na.rm = TRUE)
tail(who, n=20)
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population, na.rm = TRUE)
tail(who, n=20)
tail(pct_pop_df, n=20)
head(pct_pop_df, n=20)
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
summarise(percent = count/population, na.rm = TRUE)
summary(pct_pop_df)
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population)
head(pct_pop_df)
who <- who %>%
mutate_at('population', ~replace_na(., 0))
tail(who)
head(who)
pct_pop_df <- who %>%
group_by(year, gender, diagnostic) %>%
mutate(percent = count/population)
tail(pct_pop_df)
head(pct_pop_df)
pct_pop_df <- pct_pop_df %>%
group_by(year, gender, diagnostic) %>%
summarise(mean_pct = mean(percent), na.rm = TRUE)
head(pct_pop_df)
pct_pop_df <- pct_pop_df %>%
group_by(year, gender, diagnostic) %>%
summarise(mean_pct = mean(percent), na.rm = FALSE)
remove(pct_pop_df)
pct_pop_df <- who %>%
mutate(percent = count/population)
View(pct_pop_df)
View(who)
data(who)
data(population)
tail(who)
who <- who %>%
pivot_longer(
cols = new_sp_m014:newrel_f65,
names_to = c('diagnostic', 'gender', 'age'),
names_pattern = "new_?(.*)_(.)(.*)",
values_to = 'count'
)
tail(who)
who <- who %>%
left_join(population, by= c('country', 'year'))
head(who)
tail(who)
who <- separate(who, col=age, into = c('min_age', 'max_age'),
sep = "(?<=\\d)(?=\\d{2}$)", remove = TRUE,
convert = FALSE, fill = "warn")
tail(who, n=10)
who <- who %>%
mutate_at(8, ~replace_na(., 'Inf'))
tail(who, n=10)
head(who)
who <- who %>%
mutate_at('count', ~replace_na(., 0))
tail(who)
head(who)
summary_counts <- who %>%
group_by(diagnostic, gender) %>%
summarise(events = sum(count, na.rm = FALSE)
# or set na.rm = TRUE without changing NA to 0 first
)
print(summary_counts)
who$diagnostic <- factor(who$diagnostic)
str(who$diagnostic)
ggplot(who,aes(x=gender,y = count, fill=diagnostic)) +
geom_col() +
labs(x='Gender',
y='Count',
title='Number of TB events found per diagnostic') +
labs(y = 'Counts') +
facet_grid(.~diagnostic)
View(who)
who <- who %>%
mutate_at('population', ~replace_na(., 0))
tail(who)
head(who)
pct_pop_df <- who %>%
mutate(percent = count/population)
tail(pct_pop_df)
head(pct_pop_df)
pct_pop_df <- pct_pop_df %>%
group_by(year, gender, diagnostic) %>%
summarise(mean_pct = mean(percent), na.rm = TRUE)
tail(pct_pop_df)
head(pct_pop_df)
pct_pop_df <- who %>%
mutate(percent = count/population, na.rm = TRUE)
ead(pct_pop_df)
tail(pct_pop_df)
head(pct_pop_df)
pct_pop_df <- who %>%
mutate(percent = (count/population))
tail(pct_pop_df)
head(pct_pop_df)
pct_pop_df <- pct_pop_df %>%
group_by(year, gender, diagnostic) %>%
summarise(mean_pct = mean(percent), na.rm = TRUE)
pct_pop_df <- pct_pop_df %>%
.group(year, gender, diagnostic) %>%
summarise(mean_pct = mean(percent), na.rm = TRUE)
pct_pop_df <- pct_pop_df %>%
group_by_all(year, gender, diagnostic) %>%
summarise(mean_pct = mean(percent), na.rm = TRUE)
